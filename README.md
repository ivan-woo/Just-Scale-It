# Nike System Design

## Overview

Nike System Design was an app with inherited legacy code of Nike's Main Product Display that was scaled and optimized in order to handle production level traffic. The database was migrated from a NoSQL MongoDB to a Relational PostgreSQL database. Sample data size was generated by querying a sneaker database API, then generated 10 million entries by creating a CSV file and copying into PostgreSQL database. Server was stress tested locally using k6 and New Relic, then later deployed onto EC2 and stress trested using Loader.io.

# Metrics

*Achievements: 355% throughput increase (610rps - 2775rps), 97% latency reduction (2700ms - 88ms), 0.8% error rate*

Baseline
![Image](./results/baseline.png)

Final
![Image](./results/final.png)

## Instructions

1. Run `npm install` to install dependencies.
2. In database2/postgresIndex.js, change the input fields to your PostgreSQL credentials.
3. Run `node database2/seedProduct.js`. **WARNING** This script will generate 10 million records in a CSV file within the database2 folder.
4. Within your PostgreSQL database, create your table with this command using:
    ```
    CREATE TABLE products(
      product_id SERIAL PRIMARY KEY,
      product_name varchar(100),
      favorite varchar(10) not null DEFAULT false,
      details TEXT not null,
      style varchar(100),
      moreBenefits TEXT not null,
      colorway varchar(200) not null,
      price NUMERIC not null,
      media TEXT[],
      sizes NUMERIC[],
      stock INTEGER[]
    );
    ```
5. Run this command to seed your database from the CSV file:
    ```
    COPY products(product_name, details, colorway, price, sizes, stock, media, style, moreBenefits)
    FROM 'pathToCSVfile'
    DELIMITER ','
    CSV HEADER;
    ```
6. Run `npm start` to start your server. Server will be listening on Port 3002.